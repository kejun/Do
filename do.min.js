(function(){var k=document,l={};function o(a){return a.constructor===Array}function s(a){window.console&&window.console.log&&window.console.log(a)}var h={core_lib:["http://t.douban.com/js/jquery1.4.2.min.js"],mods:{}},m={},i=k.getElementsByTagName("script")[0];function j(a,d,c,e){if(a)if(l[a]){m[a]=false;e&&e(a)}else if(m[a])setTimeout(function(){j(a,d,c,e)},10);else{m[a]=true;var b,f=d||a.toLowerCase().substring(a.lastIndexOf(".")+1);if(f==="js"){b=k.createElement("script");b.setAttribute("type",
"text/javascript");b.setAttribute("src",a)}else if(f==="css"){b=k.createElement("link");b.setAttribute("type","text/css");b.setAttribute("rel","stylesheet");b.setAttribute("href",a);l[a]=true}if(c)b.charset=c;if(f==="css"){i.parentNode.insertBefore(b,i);e&&e(a)}else{b.onload=b.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){l[this.getAttribute("src")]=true;e&&e(this.getAttribute("src"));b.onload=b.onreadystatechange=null}};i.parentNode.insertBefore(b,
i)}}}function t(a){if(a&&o(a)){for(var d=0,c,e=[],b=h.mods,f=[],n={},q=function(g){var u=0,p;if(n[g])return f;n[g]=true;if(b[g].requires){for(p=b[g].requires;g=p[u++];){b[g]&&q(g);f.push(g)}return f}return f};c=a[d++];){if(b[c]&&b[c].requires&&b[c].requires[0]){f=[];n={};e=e.concat(q(c))}e.push(c)}return e}}function r(a){if(a&&o(a)){this.queue=a;this._skip={}}}r.prototype={_Timeout:6000,_interval:10,start:function(){var a=this;if(this.current=this.next()){this._outTimer=setTimeout(function(){s('[DoubanJS] "'+
a.current+'" timeout.');a._skip[a.current]=true;a.start()},this._Timeout);this.run()}else this.end=true},run:function(){var a=this,d;if(typeof this.current==="function"){this.clearTimer();this.current();this.start()}else if(typeof this.current==="string")if(h.mods[this.current]){d=h.mods[this.current];j(d.path,d.type,d.charset,function(c){if(!a._skip[c]){a.clearTimer();a.start()}})}else if(/\.js|\.css/i.test(this.current))j(this.current,"","",function(c){if(!a._skip[c]){a.clearTimer();a.start()}});
else{this.clearTimer();this.start()}},clearTimer:function(){clearTimeout(this._outTimer)},next:function(){return this.queue.shift()}};j(h.core_lib[0],"js");this.Do=function(){var a=Array.prototype.slice.call(arguments,0);a=new r(t(h.core_lib.concat(a)));a.start()};this.Do.add=function(a,d){!a||!d||!d.path||(h.mods[a]=d)}})();
